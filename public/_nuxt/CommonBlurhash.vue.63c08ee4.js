import{d as le,bb as be,a as ge,x as ve,a5 as ze,bw as _e,o as M,c as O,L as we,M as Se,j as Ae,aF as Z,h as ne,m as Ee}from"./entry.6470c283.js";const Le="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~",V=(e,t,a)=>{let r=0;for(;t<a;)r*=83,r+=Le.indexOf(e[t++]);return r},ie=Math.pow,H=Math.PI,Be=H*2,ue=3294.6,de=269.025,Ie=e=>e>10.31475?ie(e/de+.052132,2.4):e/ue,X=e=>~~(e>1227e-8?de*ie(e,.416666)-13.025:e*ue+1),k=e=>(e<0?-1:1)*e*e,ce=e=>{for(e+=H/2;e>H;)e-=Be;const t=1.27323954*e-.405284735*k(e);return .225*(k(t)-t)+t};function Ce(e){const t=V(e,2,6);return[t>>16,t>>8&255,t&255]}function Pe(e,t,a,r){const c=V(e,0,1),s=c%9+1,i=~~(c/9)+1,n=s*i;let o=0,p=0,f=0,d=0,l=0,y=0,C=0,_=0,L=0,b=0,w=0,q=0,$=0,S=0;const z=(V(e,1,2)+1)/13446*(r|1),g=new Float64Array(n*3),Y=Ce(e);for(o=0;o<3;o++)g[o]=Ie(Y[o]);for(o=1;o<n;o++)S=V(e,4+o*2,6+o*2),g[o*3]=k(~~(S/(19*19))-9)*z,g[o*3+1]=k(~~(S/19)%19-9)*z,g[o*3+2]=k(S%19-9)*z;const D=t*4,A=new Uint8ClampedArray(D*a);for(d=0;d<a;d++)for(q=H*d/a,f=0;f<t;f++){for(l=0,y=0,C=0,$=H*f/t,p=0;p<i;p++)for(L=ce(q*p),o=0;o<s;o++)_=ce($*o)*L,b=(o+p*s)*3,l+=g[b]*_,y+=g[b+1]*_,C+=g[b+2]*_;w=4*f+d*D,A[w]=X(l),A[w+1]=X(y),A[w+2]=X(C),A[w+3]=255}return A}const fe=typeof window>"u",Te=!fe&&"loading"in HTMLImageElement.prototype,Ue=!fe&&(!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent));function Re(e,t=document){return typeof e=="string"?[...t.querySelectorAll(e)]:e instanceof Element?[e]:[...e]}function Me(e,t){let a,r;return e>=1?(a=t,r=Math.round(t/e)):(a=Math.round(t*e),r=t),{width:a,height:r}}function ke(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),a=typeof Buffer<"u"?Buffer.from(t,"base64"):Uint8Array.from(atob(t),r=>r.charCodeAt(0));return new Uint8Array(a)}function He(e,t){let a;return function(...r){a&&clearTimeout(a),a=setTimeout(()=>{a=void 0,e(...r)},t)}}/**
 * Encodes an RGBA image to a PNG data URI. RGB should not be premultiplied by A.
 *
 * @remarks
 * This is optimized for speed and simplicity and does not optimize for size
 * at all. This doesn't do any compression (all values are stored uncompressed).
 *
 * @see https://github.com/evanw/thumbhash
 * @author Evan Wallace
 * @license MIT
 */function pe(e,t,a){const r=e*4+1,c=6+t*(5+r),s=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,e>>8,e&255,0,0,t>>8,t&255,8,6,0,0,0,0,0,0,0,c>>>24,c>>16&255,c>>8&255,c&255,73,68,65,84,120,1],i=[0,498536548,997073096,651767980,1994146192,1802195444,1303535960,1342533948,-306674912,-267414716,-690576408,-882789492,-1687895376,-2032938284,-1609899400,-1111625188];let n=1,o=0;for(let f=0,d=0,l=r-1;f<t;f++,l+=r-1)for(s.push(f+1<t?0:1,r&255,r>>8,~r&255,r>>8^255,0),o=(o+n)%65521;d<l;d++){const y=a[d]&255;s.push(y),n=(n+y)%65521,o=(o+n)%65521}s.push(o>>8,o&255,n>>8,n&255,0,0,0,0,0,0,0,0,73,69,78,68,174,66,96,130);for(let[f,d]of[[12,29],[37,41+c]]){let l=-1;for(let y=f;y<d;y++)l^=s[y],l=l>>>4^i[l&15],l=l>>>4^i[l&15];l=~l,s[d++]=l>>>24,s[d++]=l>>16&255,s[d++]=l>>8&255,s[d++]=l&255}return`data:image/png;base64,${typeof Buffer<"u"?Buffer.from(new Uint8Array(s)).toString("base64"):btoa(String.fromCharCode(...s))}`}const Q=32;function qe(e,{ratio:t=1,size:a=Q}={}){const{width:r,height:c}=Me(t,a),s=Pe(e,r,c);return pe(r,c,s)}function $e(e){let{PI:t,min:a,max:r,cos:c,round:s}=Math,i=e[0]|e[1]<<8|e[2]<<16,n=e[3]|e[4]<<8,o=(i&63)/63,p=(i>>6&63)/31.5-1,f=(i>>12&63)/31.5-1,d=(i>>18&31)/31,l=i>>23,y=(n>>3&63)/63,C=(n>>9&63)/63,_=n>>15,L=r(3,_?l?5:7:n&7),b=r(3,_?n&7:l?5:7),w=l?(e[5]&15)/15:1,q=(e[5]>>4)/15,$=l?6:5,S=0,z=(T,v,U)=>{let B=[];for(let E=0;E<v;E++)for(let I=E?0:1;I*v<T*(v-E);I++)B.push(((e[$+(S>>1)]>>((S++&1)<<2)&15)/7.5-1)*U);return B},g=z(L,b,d),Y=z(3,3,y*1.25),D=z(3,3,C*1.25),A=l&&z(5,5,q),F=De(e),x=s(F>1?32:32*F),W=s(F>1?32/F:32),P=new Uint8Array(x*W*4),j=[],N=[];for(let T=0,v=0;T<W;T++)for(let U=0;U<x;U++,v+=4){let B=o,E=p,I=f,re=w;for(let u=0,h=r(L,l?5:3);u<h;u++)j[u]=c(t/x*(U+.5)*u);for(let u=0,h=r(b,l?5:3);u<h;u++)N[u]=c(t/W*(T+.5)*u);for(let u=0,h=0;u<b;u++)for(let m=u?0:1,R=N[u]*2;m*b<L*(b-u);m++,h++)B+=g[h]*j[m]*R;for(let u=0,h=0;u<3;u++)for(let m=u?0:1,R=N[u]*2;m<3-u;m++,h++){let oe=j[m]*R;E+=Y[h]*oe,I+=D[h]*oe}if(l)for(let u=0,h=0;u<5;u++)for(let m=u?0:1,R=N[u]*2;m<5-u;m++,h++)re+=A[h]*j[m]*R;let ae=B-2/3*E,se=(3*B-ae+I)/2,me=se-I;P[v]=r(0,255*a(1,se)),P[v+1]=r(0,255*a(1,me)),P[v+2]=r(0,255*a(1,ae)),P[v+3]=r(0,255*a(1,re))}return{w:x,h:W,rgba:P}}function De(e){let t=e[3],a=e[2]&128,r=e[4]&128,c=r?a?5:7:t&7,s=r?t&7:a?5:7;return c/s}function Fe(e){const{w:t,h:a,rgba:r}=$e(ke(e));return pe(t,a,r)}function xe(e='img[loading="lazy"]',{hash:t=!0,hashType:a="blurhash",placeholderSize:r=Q,updateSizesOnResize:c=!1,onImageLoad:s}={}){const i=new Set;for(const n of Re(e)){if(i.add(K(n,c)),n.parentElement?.tagName.toLowerCase()==="picture"&&[...n.parentElement.getElementsByTagName("source")].forEach(p=>K(p)),t){const p=he({image:n,hash:typeof t=="string"?t:void 0,hashType:a,size:r});p&&(n.src=p)}if(!n.dataset.src&&!n.dataset.srcset){console.error("[unlazy] Missing `data-src` or `data-srcset` attribute",n);continue}if(Ue||!Te){ye(n),te(n),ee(n);continue}if(n.complete&&n.naturalWidth>0){J(n,s);continue}const o=()=>J(n,s);n.addEventListener("load",o,{once:!0}),i.add(()=>n.removeEventListener("load",o))}return()=>{for(const n of i)n();i.clear()}}function J(e,t){const a=new Image,{srcset:r,src:c,sizes:s}=e.dataset;r&&(a.srcset=r),c&&(a.src=c),s&&(a.sizes=s),a.addEventListener("load",()=>{ye(e),te(e),ee(e),t?.(e)})}function he({image:e,hash:t,hashType:a="blurhash",size:r=Q,ratio:c}={}){if(!t&&e){const{blurhash:s,thumbhash:i}=e.dataset;t=i||s,a=i?"thumbhash":"blurhash"}if(t)try{if(a==="thumbhash")return Fe(t);if(!c&&e){const s=e.width||e.offsetWidth||r,i=e.height||e.offsetHeight||r;c=s/i}return qe(t,{ratio:c,size:r})}catch(s){console.error(`Error generating ${a} placeholder:`,s)}}const G=new WeakMap;function K(e,t=!1){const a=()=>{const s=G.get(e);s&&(s.disconnect(),G.delete(e))},{sizes:r}=e.dataset;if(r!=="auto")return a;const c=e instanceof HTMLSourceElement?e.parentElement?.getElementsByTagName("img")[0]?.offsetWidth:e.offsetWidth;if(c&&(e.sizes=`${c}px`),t&&!G.has(e)){const s=He(()=>K(e),500),i=new ResizeObserver(s);G.set(e,i),i.observe(e)}return a}function ee(e){e.dataset.src&&(e.src=e.dataset.src,e.removeAttribute("data-src"))}function te(e){e.dataset.srcset&&(e.srcset=e.dataset.srcset,e.removeAttribute("data-srcset"))}function ye(e){const t=e.parentElement;t?.tagName.toLowerCase()==="picture"&&([...t.querySelectorAll("source[data-srcset]")].forEach(te),[...t.querySelectorAll("source[data-src]")].forEach(ee))}const We={key:0},je=["type","data-srcset","data-sizes"],Ne=["src","data-src","data-srcset","data-sizes"],Oe=["src","data-src","data-srcset","data-sizes"],Ge=le({inheritAttrs:!1,__name:"UnLazyImage",props:{src:{default:void 0},srcSet:{default:void 0},sources:{default:void 0},autoSizes:{type:Boolean,default:!1},blurhash:{default:void 0},thumbhash:{default:void 0},placeholderSrc:{default:void 0},placeholderSize:{default:void 0},placeholderRatio:{default:void 0},lazyLoad:{type:Boolean,default:!0},preload:{type:Boolean,default:!1},ssr:{type:Boolean,default:void 0}},setup(e){const t=e,a=be().public.unlazy,r=ge(()=>t.thumbhash||t.blurhash),c=void 0,s=ve();let i,n;return ze(()=>{if(i?.(),!!s.value){if(r.value&&r.value!==n){const o=he({image:s.value,hash:r.value,hashType:t.thumbhash?"thumbhash":"blurhash",size:t.placeholderSize||a.placeholderSize,ratio:t.placeholderRatio});o&&(s.value.src=o),n=r.value}if(t.preload){J(s.value);return}t.lazyLoad&&(i=xe(s.value,{hash:!1}))}}),_e(()=>{i?.()}),(o,p)=>t.sources?.length?(M(),O("picture",We,[(M(!0),O(we,null,Se(t.sources,(f,d)=>(M(),O("source",{key:d,type:f.type,"data-srcset":f.srcSet,"data-sizes":f.sizes},null,8,je))),128)),Ae("img",Z({ref_key:"target",ref:s},o.$attrs,{src:ne(c)||o.placeholderSrc,"data-src":o.src,"data-srcset":o.srcSet,"data-sizes":o.autoSizes?"auto":void 0,loading:"lazy"}),null,16,Ne)])):(M(),O("img",Z({key:1,ref_key:"target",ref:s},o.$attrs,{src:ne(c)||o.placeholderSrc,"data-src":o.src,"data-srcset":o.srcSet,"data-sizes":o.autoSizes?"auto":void 0,loading:"lazy"}),null,16,Oe))}}),Ye=le({inheritAttrs:!1,__name:"CommonBlurhash",props:{blurhash:{default:""},src:{},srcset:{},shouldLoadImage:{type:Boolean,default:!0}},setup(e){return(t,a)=>{const r=Ge;return M(),Ee(r,Z(t.$attrs,{blurhash:t.blurhash,src:t.src,"src-set":t.srcset,"lazy-load":t.shouldLoadImage,"auto-sizes":""}),null,16,["blurhash","src","src-set","lazy-load"])}}});export{Ye as _};
