import{a as F,_ as U}from"./SearchHashtagInfo.vue.6773582e.js";import{d as H,o as n,c as i,f as k,j as s,m as x,k as C,ac as q,ae as z,ag as T,ah as W,ai as j,w as G,a3 as J,ap as O,x as d,B as P,C as Q,a as L,cc as R,F as M,y as A,cd as X,cb as Y,q as Z,i as ee,ce as te,b7 as ae,b as ne,aw as se,cf as oe,a8 as ce,a9 as le,h as c,aa as ue,ax as B,aG as V,t as D,L as K,M as re}from"./entry.6470c283.js";import{e as ie}from"./StatusCard.vue.1da0e372.js";const de={flex:"","gap-2":"","items-center":""},pe={flex:"~ col gap1",shrink:"","h-full":"","overflow-hidden":"","leading-none":""},ve={flex:"~","gap-2":""},_e=H({__name:"SearchAccountInfo",props:{account:{}},setup(m){return(l,e)=>{const p=q,g=z,u=T,r=W,a=j;return n(),i("div",de,[k(p,{"w-10":"","h-10":"",account:l.account,"shrink-0":""},null,8,["account"]),s("div",pe,[s("div",ve,[k(g,{account:l.account,"line-clamp-1":"","ws-pre-wrap":"","break-all":"","text-base":""},null,8,["account"]),l.account.locked?(n(),x(u,{key:0,"text-xs":""})):C("",!0),l.account.bot?(n(),x(r,{key:1,"text-xs":""})):C("",!0)]),k(a,{"text-sm":"",account:l.account,"text-secondary-light":""},null,8,["account"])])])}}}),fe=H({__name:"SearchResult",props:{result:{},active:{type:Boolean}},setup(m){function l(){document.activeElement.blur()}return(e,p)=>{const g=F,u=_e,r=ie,a=U;return n(),x(a,{as:"RouterLink","hover:bg-active":"",active:e.active,to:e.result.to,py2:"",block:"",px2:"","aria-selected":e.active,class:J({"bg-active":e.active}),onClick:p[0]||(p[0]=()=>l())},{default:G(()=>[e.result.type==="hashtag"?(n(),x(g,{key:0,hashtag:e.result.data},null,8,["hashtag"])):e.result.type==="account"?(n(),x(u,{key:1,account:e.result.data},null,8,["account"])):e.result.type==="status"?(n(),x(r,{key:2,status:e.result.data,actions:!1,"show-reply-to":!1},null,8,["status"])):C("",!0)]),_:1},8,["active","to","aria-selected","class"])}}}),he={},me={flex:"","flex-col":"","gap-2":"","px-4":"","py-3":""},ge=s("div",{flex:"","gap-4":""},[s("div",null,[s("div",{"w-12":"","h-12":"","rounded-full":"",class:"skeleton-loading-bg"})]),s("div",{flex:"~ col 1 gap-2",pb2:"","min-w-0":""},[s("div",{flex:"",class:"skeleton-loading-bg","h-5":"","w-20":"",rounded:""}),s("div",{flex:"",class:"skeleton-loading-bg","h-4":"","w-full":"",rounded:""})])],-1),ye=[ge];function be(m,l){return n(),i("div",me,ye)}const xe=O(he,[["render",be]]);function ke(m,l={}){const e=d(!1),p=P(),g=Q(p,"client"),u=d(!1),r=d([]),a=d([]),v=d([]),y=L(()=>R(m).trim());let _;const w=(t,S=!1)=>{S&&(r.value=[],a.value=[],v.value=[]),r.value=[...r.value,...t.accounts.map(o=>({type:"account",id:o.id,data:o,to:ee(o)}))],a.value=[...a.value,...t.hashtags.map(o=>({type:"hashtag",id:`hashtag-${o.name}`,data:o,to:te(o.name)}))],v.value=[...v.value,...t.statuses.map(o=>({type:"status",id:o.id,data:o,to:ae(o)}))]};M(()=>R(m),()=>{u.value=!!(y.value&&A.value)}),X(()=>R(m),async()=>{if(!y.value||!A.value)return;u.value=!0,_=g.value.v2.search({q:y.value,...R(l),resolve:!!Z.value});const t=await _.next();e.value=!!t.done,t.done||w(t.value,!0),u.value=!1},{debounce:300});const $=async()=>{if(!y.value||!A.value||!_)return;u.value=!0;const t=await _.next();u.value=!1,e.value=!!t.done,t.done||w(t.value)};return{accounts:r,hashtags:a,statuses:v,loading:Y(u),next:$}}const we={"bg-base":"",border:"~ base",h10:"","ps-4":"","pe-1":"","rounded-3":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":""},$e=s("div",{"i-ri:search-2-line":"","pointer-events-none":"","text-secondary":"",mt:"1px",class:"rtl-flip"},null,-1),Se=["placeholder","onKeypress"],Re=s("span",{"aria-hidden":"true",class:"i-ri:close-line"},null,-1),Ae=[Re],Ce={"left-0":"","top-11":"",absolute:"","w-full":"",z10:"","group-focus-within":"pointer-events-auto visible",invisible:"","pointer-events-none":""},Ie={"w-full":"","bg-base":"",border:"~ base","rounded-3":"","max-h-100":"","overflow-auto":"",py2:""},Be={key:0,block:"","text-center":"","text-sm":"","text-secondary":""},He={key:1,block:"","text-center":"","text-sm":"","text-secondary":""},Ve={key:2},Me=H({__name:"SearchWidget",setup(m,{expose:l}){const e=d(""),{accounts:p,hashtags:g,loading:u,statuses:r}=ke(e),a=d(0),{t:v}=ne(),y=d(),_=d(),w=se(),{focused:$}=oe(y);l({input:_});const t=L(()=>e.value.length===0?[]:[...g.value.slice(0,3),...p.value,...r.value]);M([t,$],()=>a.value=-1);function S(f){return a.value=(a.value+f%t.value.length+t.value.length)%t.value.length}function o(){const f=a.value;if(e.value.length!==0){if(f===-1){a.value=0;return}document.activeElement.blur(),a.value=-1,w.push(t.value[f].to)}}return(f,h)=>{const N=fe,I=xe;return n(),i("div",{ref_key:"el",ref:y,relative:"",group:""},[s("div",we,[$e,ce(s("input",{ref_key:"input",ref:_,"onUpdate:modelValue":h[0]||(h[0]=b=>ue(e)?e.value=b:null),"h-full":"","rounded-3":"","w-full":"","bg-transparent":"",outline:"focus:none","ps-3":"","pe-1":"","ml-1":"",placeholder:("isHydrated"in f?f.isHydrated:c(A))?c(v)("nav.search"):"",pb:"1px","placeholder-text-secondary":"",onKeydown:[h[1]||(h[1]=B(V(b=>S(1),["prevent"]),["down"])),h[2]||(h[2]=B(V(b=>S(-1),["prevent"]),["up"]))],onKeypress:B(o,["enter"])},null,40,Se),[[le,c(e)]]),c(e).length?(n(),i("button",{key:0,"btn-action-icon":"","text-secondary":"",onClick:h[3]||(h[3]=b=>{e.value="",c(_)?.focus()})},Ae)):C("",!0)]),s("div",Ce,[s("div",Ie,[c(e).trim().length===0?(n(),i("span",Be,D(c(v)("search.search_desc")),1)):c(u)?(n(),i("div",Ve,[k(I),k(I),k(I)])):(n(),i(K,{key:1},[c(t).length>0?(n(!0),i(K,{key:0},re(c(t),(b,E)=>(n(),x(N,{key:b.id,active:c(a)===parseInt(E.toString()),result:b,tabindex:c($)?0:-1},null,8,["active","result","tabindex"]))),128)):(n(),i("span",He,D(c(v)("search.search_empty")),1))],64))])])],512)}}});export{Me as _,xe as a,fe as b,ke as u};
