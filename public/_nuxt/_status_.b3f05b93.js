import{_ as K,a as O,b as Q,c as X,d as Y,e as Z}from"./StatusCard.vue.1da0e372.js";import{d as D,a as E,u as tt,b as et,e as at,g as st,r as nt,o as a,c as f,f as r,w as l,h as e,i as ot,j as i,t as y,k as m,l as L,m as o,_ as ut,n as rt,p as M,q as U,s as it,v as ct,x as T,y as A,z as F,A as lt,B as dt,C as _t,D as H,E as mt,F as pt,G as ft,H as vt,I as yt,J as ht,K as bt,L as I,M as $t}from"./entry.6470c283.js";import{_ as gt}from"./PublishWidget.99c41a95.js";import{_ as kt}from"./CommonNotFound.7245bde1.js";import{s as wt,a as xt,_ as St,b as At}from"./CommonPaginator.vue.26cfe48c.js";import{u as V}from"./asyncData.d016a388.js";import"./AccountInlineInfo.vue.1d2999da.js";import"./Dropdown.vue.aa86e3bf.js";import"./StatusAttachment.vue.65a4200d.js";import"./CommonBlurhash.vue.63c08ee4.js";import"./StatusPreviewCard.vue.01b2746b.js";import"./CommonErrorMessage.vue.8ac3d45b.js";import"./ModalDialog.7f5b2796.js";import"./CommonCheckbox.vue.87c89bd7.js";import"./index.modern.9fe7b5ad.js";import"./SearchHashtagInfo.vue.6773582e.js";import"./CommonTrendingCharts.vue.860ab26d.js";import"./web-share-target.81d4b600.js";const Ct=["id","lang"],Nt={flex:"~ gap-1","items-center":"","text-secondary":"","text-sm":""},Rt={flex:""},Dt={ms1:"","font-bold":"","cursor-pointer":""},Et=i("div",{"aria-hidden":"true"}," · ",-1),Bt={key:0,"aria-hidden":"true"},Tt={key:1},Ft={key:2},Ht={border:"t base","py-2":""},It=D({__name:"StatusDetails",props:{status:{},newer:{},command:{type:Boolean},actions:{type:Boolean,default:!0}},emits:["refetchStatus"],setup(h){const u=h,t=E(()=>u.status.reblog&&u.status.reblog?u.status.reblog:u.status),p=tt(t.value.createdAt),{t:s}=et();return at({title:()=>`${st(t.value.account)} ${s("common.in")} ${s("app_name")}: "${nt(t.value.content)||""}"`}),(n,b)=>{const C=K,N=ut,d=rt,_=M,k=O,w=Q,$=X,x=Y;return a(),f("div",{id:`status-${t.value.id}`,flex:"","flex-col":"","gap-2":"",pt2:"",pb1:"","ps-3":"","pe-4":"",relative:"",lang:t.value.language??void 0,"aria-roledescription":"status-details"},[r(C,{status:t.value,absolute:"","inset-ie-2":"","top-2":"",onAfterEdit:b[0]||(b[0]=R=>n.$emit("refetchStatus"))},null,8,["status"]),r(_,{to:("getAccountRoute"in n?n.getAccountRoute:e(ot))(t.value.account),"rounded-full":"","hover:bg-active":"","transition-100":"",pe5:"","me-a":""},{default:l(()=>[r(d,{account:t.value.account},{default:l(()=>[r(N,{account:t.value.account},null,8,["account"])]),_:1},8,["account"])]),_:1},8,["to"]),r(k,{status:t.value,newer:n.newer,context:"details"},null,8,["status","newer"]),i("div",Nt,[i("div",Rt,[i("div",null,y(e(p)),1),r(w,{status:t.value,inline:!1},{default:l(()=>[i("span",Dt,y(n.$t("state.edited")),1)]),_:1},8,["status"])]),Et,r($,{status:t.value},null,8,["status"]),t.value.application?.name?(a(),f("div",Bt," · ")):m("",!0),t.value.application?.website&&t.value.application.name?(a(),f("div",Tt,[r(_,{to:t.value.application.website},{default:l(()=>[L(y(t.value.application.name),1)]),_:1},8,["to"])])):t.value.application?.name?(a(),f("div",Ft,y(t.value.application?.name),1)):m("",!0)]),i("div",Ht,[n.actions?(a(),o(x,{key:0,status:t.value,details:"",command:n.command},null,8,["status","command"])):m("",!0)])],8,Ct)}}}),Vt={flex:"~ col center gap2"},Lt={"btn-solid":"",flex:"~ center gap-2","text-sm":"",px2:"",py1:""},Mt=i("div",{"i-ri:arrow-right-up-line":""},null,-1),Ut=D({__name:"StatusNotFound",props:{account:{},status:{}},setup(h){const u=E(()=>{const[t,p]=h.account.split("@"),s=p||U.value?.server;return s?`https://${s}/@${t}/${h.status}`:null});return(t,p)=>{const s=M,n=kt;return a(),o(n,null,{default:l(()=>[i("div",Vt,[i("div",null,y(t.$t("error.status_not_found")),1),e(u)?(a(),o(s,{key:0,to:e(u),external:"",target:"_blank"},{default:l(()=>[i("button",Lt,[Mt,L(" "+y(t.$t("status.try_original_site")),1)])]),_:1},8,["to"])):m("",!0)])]),_:1})}}}),Wt={key:0,"xl:mt-4":"",mb:"50vh",border:"b base"},ue=D({__name:"[status]",setup(h){const u=it(),t=ct(()=>u.params.status),p=T(null),{data:s,pending:n,refresh:b}=V(`status:${t.value}`,()=>lt(t.value,!0),{watch:[A],immediate:A.value,default:()=>F()}),C=dt(),N=_t(C,"client"),{data:d,pending:_,refresh:k}=V(`context:${t.value}`,async()=>N.value.v1.statuses.fetchContext(t.value),{watch:[A],immediate:A.value,lazy:!0,default:()=>F()});_&&H(_,w),n&&H(n,w);async function w(){await ht();const g=bt(p);g&&g.scrollIntoView(!0)}const $=T();function x(){return $.value?.focusEditor?.()}mt("focus-editor",x),pt($,()=>{window.history.state.focusReply&&x()});const R=E(()=>s.value?ft(s.value):null);return vt(()=>{b(),k()}),(g,S)=>{const B=Z,W=It,z=gt,P=Ut,j=St,q=At,G=yt;return a(),o(G,{back:""},{default:l(()=>[e(n)?(a(),o(j,{key:1,border:"b base"})):(a(),f(I,{key:0},[e(s)?(a(),f("div",Wt,[e(_)?m("",!0):(a(!0),f(I,{key:0},$t(e(d)?.ancestors,(c,v)=>(a(),o(B,{key:c.id,status:c,actions:c.visibility!=="direct",context:"account","has-older":!0,newer:e(d)?.ancestors[v-1]},null,8,["status","actions","newer"]))),128)),r(W,{ref_key:"main",ref:p,status:e(s),newer:e(d)?.ancestors.at(-1),command:"",style:{"scroll-margin-top":"60px"},onRefetchStatus:S[0]||(S[0]=c=>e(b)())},null,8,["status","newer"]),("currentUser"in g?g.currentUser:e(U))?(a(),o(z,{key:1,ref_key:"publishWidget",ref:$,border:"y base","draft-key":R.value.key,initial:R.value.draft,onPublished:S[1]||(S[1]=c=>e(k)())},null,8,["draft-key","initial"])):m("",!0),e(_)?m("",!0):(a(),o(e(wt),{key:2,items:e(d)?.descendants||[],"min-item-size":200,buffer:800,"key-field":"id","page-mode":""},{default:l(({item:c,index:v,active:J})=>[r(e(xt),{item:c,active:J},{default:l(()=>[(a(),o(B,{key:c.id,status:c,context:"account",older:e(d)?.descendants[v+1],newer:v>0?e(d)?.descendants[v-1]:e(s),"has-newer":v===0,main:e(s)},null,8,["status","older","newer","has-newer","main"]))]),_:2},1032,["item","active"])]),_:1},8,["items"]))])):(a(),o(P,{key:1,account:e(u).params.account,status:e(t)},null,8,["account","status"]))],64)),e(n)||e(_)?(a(),o(q,{key:2})):m("",!0)]),_:1})}}});export{ue as default};
