import{d as B,a as G,x as z,o,c as d,j as i,m as r,L as A,f as p,t as b,h,M as H,w as _,i as I,bg as j,ae as E,ac as M,p as F,n as P,S as q,k as L,a3 as J,a6 as O,cg as T,aM as U}from"./entry.6470c283.js";import{_ as W}from"./AccountCard.vue.4086cce4.js";import{f as X,g as K,h as Q,i as Y,e as Z}from"./StatusCard.vue.1da0e372.js";import{_ as x}from"./AccountBigCard.vue.d39f6f06.js";import{_ as tt}from"./AccountInlineInfo.vue.1d2999da.js";import{a as ot,c as et}from"./CommonPaginator.vue.26cfe48c.js";import{u as nt}from"./notification.318359a8.js";const at=["lang"],it={flex:"","items-center":"","top-0":"","left-2":"","pt-2":"","px-3":""},st=i("div",{"i-ri:user-follow-fill":"","me-3":"","color-primary":"","aria-hidden":"true"},null,-1),ct={"me-1":"","ws-nowrap":""},ut={"pb-2":""},rt={key:0},lt={key:1,flex:"~ wrap gap-1.75",p4:""},pt=B({__name:"NotificationGroupedFollow",props:{items:{}},setup(N){const t=G(()=>N.items.items.length),C=z(!1),m=G(()=>t.value>1||t.value===0?void 0:N.items.items[0].status?.language);return(e,R)=>{const k=j,v=E,w=W,a=M,s=F,l=P;return o(),d("article",{flex:"","flex-col":"",relative:"",lang:m.value??void 0},[i("div",it,[st,t.value>1?(o(),r(k,{key:0,keypath:"notification.followed_you_count",count:t.value},null,8,["count"])):(o(),d(A,{key:1},[p(v,{account:e.items.items[0]?.account,"text-primary":"","me-1":"","font-bold":"","line-clamp-1":"","ws-pre-wrap":"","break-all":""},null,8,["account"]),i("span",ct,b(e.$t("notification.followed_you")),1)],64))]),i("div",ut,[h(C)?(o(),d("div",rt,[(o(!0),d(A,null,H(e.items.items,f=>(o(),r(w,{key:f.id,account:f.account,p3:""},null,8,["account"]))),128))])):(o(),d("div",lt,[(o(!0),d(A,null,H(e.items.items,f=>(o(),r(l,{key:f.id,account:f.account},{default:_(()=>[p(s,{to:("getAccountRoute"in e?e.getAccountRoute:h(I))(f.account)},{default:_(()=>[p(a,{account:f.account,"w-12":"","h-12":""},null,8,["account"])]),_:2},1032,["to"])]),_:2},1032,["account"]))),128))]))])],8,at)}}}),ft={flex:"","flex-col":"",relative:""},dt={flex:"","flex-col":"","gap-2":""},mt={key:0,flex:"~ gap-1"},_t=i("div",{"i-ri:repeat-fill":"","text-xl":"","me-1":"","color-green":""},null,-1),gt={ml1:""},yt={key:1,flex:"~ gap-1"},ht={ml1:""},vt={pl8:"","mt-1":""},bt=B({__name:"NotificationGroupedLikes",props:{group:{}},setup(N){const t=q("useStarFavoriteIcon"),C=G(()=>N.group.likes.filter(e=>e.reblog)),m=G(()=>N.group.likes.filter(e=>e.favourite&&!e.reblog));return(e,R)=>{const k=M,v=F,w=P,a=X,s=K,l=Q,f=Y;return o(),d("article",ft,[p(f,{status:e.group.status,pb2:"",pt3:""},{default:_(()=>[i("div",dt,[C.value.length?(o(),d("div",mt,[_t,(o(!0),d(A,null,H(C.value,(c,$)=>(o(),r(w,{key:$,account:c.account},{default:_(()=>[p(v,{to:("getAccountRoute"in e?e.getAccountRoute:h(I))(c.account)},{default:_(()=>[p(k,{"text-primary":"","font-bold":"",account:c.account,class:"h-1.5em w-1.5em"},null,8,["account"])]),_:2},1032,["to"])]),_:2},1032,["account"]))),128)),i("div",gt,b(e.$t("notification.reblogged_post")),1)])):L("",!0),m.value.length?(o(),d("div",yt,[i("div",{class:J(h(t)?"i-ri:star-fill color-yellow":"i-ri:heart-fill color-red"),"text-xl":"","me-1":""},null,2),(o(!0),d(A,null,H(m.value,(c,$)=>(o(),r(w,{key:$,account:c.account},{default:_(()=>[p(v,{to:("getAccountRoute"in e?e.getAccountRoute:h(I))(c.account)},{default:_(()=>[p(k,{"text-primary":"","font-bold":"",account:c.account,class:"h-1.5em w-1.5em"},null,8,["account"])]),_:2},1032,["to"])]),_:2},1032,["account"]))),128)),i("div",ht,b(e.$t("notification.favourited_post")),1)])):L("",!0)]),i("div",vt,[p(a,{status:e.group.status,"text-secondary":""},null,8,["status"]),e.group.status.content?L("",!0):(o(),d(A,{key:0},[e.group.status.mediaAttachments?.length?(o(),r(s,{key:0,status:e.group.status,"is-preview":!1,"pointer-events-none":""},null,8,["status"])):e.group.status.poll?(o(),r(l,{key:1,status:e.group.status},null,8,["status"])):L("",!0)],64))])]),_:1},8,["status"])])}}}),kt={flex:"","flex-col":"",relative:""},wt=["lang"],$t=i("div",{"i-ri:user-follow-fill":"","me-1":"","color-primary":""},null,-1),At={"ws-nowrap":""},Nt={key:1,flex:"",p3:"","items-center":"","bg-shaded":""},Ct=i("div",{"i-ri:admin-fill":"","me-1":"","color-purple":""},null,-1),Rt={flex:"",p3:"","items-center":"","bg-shaded":""},St=i("div",{"i-ri:flag-fill":"","me-1":"","color-purple":""},null,-1),Lt={flex:"","ms-4":"","items-center":"",class:"-top-2.5",absolute:"","inset-ie-2":"","px-2":""},Gt=i("div",{"i-ri:user-follow-fill":"","text-xl":"","me-1":""},null,-1),Ht={flex:"~","gap-1":"","items-center":"",mt1:""},It=i("div",{"i-ri:edit-2-fill":"","text-xl":"","me-1":"","text-secondary":""},null,-1),Bt={"ws-nowrap":""},Ft={key:6,"text-red":"","font-bold":""},Vt=B({__name:"NotificationCard",props:{notification:{}},setup(N){return(t,C)=>{const m=E,e=x,R=F,k=O("i18n-t"),v=tt,w=W,a=Z;return o(),d("article",kt,[t.notification.type==="follow"?(o(),r(R,{key:0,to:("getAccountRoute"in t?t.getAccountRoute:h(I))(t.notification.account)},{default:_(()=>[i("div",{flex:"","items-center":"",absolute:"","ps-3":"","pe-4":"","inset-is-0":"","rounded-ie-be-3":"","py-3":"","bg-base":"","top-0":"",lang:t.notification.status?.language??void 0},[$t,p(m,{account:t.notification.account,"text-primary":"","me-1":"","font-bold":"","line-clamp-1":"","ws-pre-wrap":"","break-all":""},null,8,["account"]),i("span",At,b(t.$t("notification.followed_you")),1)],8,wt),p(e,{account:t.notification.account,lang:t.notification.status?.language??void 0},null,8,["account","lang"])]),_:1},8,["to"])):t.notification.type==="admin.sign_up"?(o(),d("div",Nt,[Ct,p(m,{account:t.notification.account,"text-purple":"","me-1":"","font-bold":"","line-clamp-1":"","ws-pre-wrap":"","break-all":""},null,8,["account"]),i("span",null,b(t.$t("notification.signed_up")),1)])):t.notification.type==="admin.report"?(o(),r(R,{key:2,to:("getReportRoute"in t?t.getReportRoute:h(T))(t.notification.report?.id)},{default:_(()=>[i("div",Rt,[St,p(k,{keypath:"notification.reported"},{default:_(()=>[p(m,{account:t.notification.account,"text-purple":"","me-1":"","font-bold":"","line-clamp-1":"","ws-pre-wrap":"","break-all":""},null,8,["account"]),p(m,{account:t.notification.report?.targetAccount,"text-purple":"","ms-1":"","font-bold":"","line-clamp-1":"","ws-pre-wrap":"","break-all":""},null,8,["account"])]),_:1})])]),_:1},8,["to"])):t.notification.type==="follow_request"?(o(),d(A,{key:3},[i("div",Lt,[Gt,p(v,{account:t.notification.account,me1:""},null,8,["account"])]),p(w,{account:t.notification.account},null,8,["account"])],64)):t.notification.type==="update"?(o(),r(a,{key:4,status:t.notification.status,"in-notification":!0,actions:!1},{meta:_(()=>[i("div",Ht,[It,p(v,{account:t.notification.account,me1:""},null,8,["account"]),i("span",Bt,b(t.$t("notification.update_status")),1)])]),_:1},8,["status"])):t.notification.type==="mention"||t.notification.type==="poll"||t.notification.type==="status"?(o(),r(a,{key:5,status:t.notification.status},null,8,["status"])):(o(),d("div",Ft," [DEV] "+b(t.$t("notification.missing_type"))+" '"+b(t.notification.type)+"' ",1))])}}}),Dt=["onClick"],D=!1,Jt=B({__name:"NotificationPaginator",props:{paginator:{},stream:{}},setup(N){const t=Number.MAX_VALUE;function C(a){const s=a.status?{status:a.status?.id,type:a.type==="reblog"||a.type==="favourite"?"like":a.type}:{type:a.type};return JSON.stringify(s)}function m(a){return!a.header.endsWith("/original/missing.png")}function e(a){const s=[];let l=0,f="",c=[];const $=()=>{if(c.length===0)return;const n=c;if(c=[],n[0].type==="follow"){const u=[...n];u.sort((g,y)=>{const S=m(g.account),V=m(y.account);return V&&!S?1:S&&!V?-1:y.account.followersCount-g.account.followersCount}),u.length>0&&m(u[0].account)&&s.push(u.shift()),u.length===1&&m(u[0].account)&&s.push(u.shift()),u.length>0&&s.push({id:`grouped-${l++}`,type:"grouped-follow",items:u});return}else if(n.length&&(n[0].type==="reblog"||n[0].type==="favourite")){if(!n[0].status)return;const u=[];for(const g of n){let y=u.find(S=>S.account.id===g.account.id);y||(y={account:g.account},u.push(y)),y[g.type==="reblog"?"reblog":"favourite"]=g}u.sort((g,y)=>g.reblog&&(!y.reblog||g.favourite&&!y.favourite)?-1:0),s.push({id:`grouped-${l++}`,type:"grouped-reblogs-and-favourites",status:n[0].status,likes:u});return}s.push(...n)};for(const n of a){const u=C(n);(f!==u||c.length>=t)&&$(),c.push(n),f=u}return $(),s}function R(a){return a.filter(s=>!s.status?.filtered?.find(l=>l.filter.filterAction==="hide"&&l.filter.context.includes("notifications")))}function k(a){const s=[];for(const l of a)if(l.type==="grouped-reblogs-and-favourites"){const f=l;for(const c of f.likes)c.reblog&&s.push(c.reblog),c.favourite&&s.push(c.favourite)}else l.type==="grouped-follow"?s.push(...l.items):s.push(l);return e(R(s))}const{clearNotifications:v}=nt(),{formatNumber:w}=U();return(a,s)=>{const l=pt,f=bt,c=Vt,$=et;return o(),r($,{paginator:a.paginator,preprocess:k,stream:a.stream,virtualScroller:D,eventType:"notification"},{updater:_(({number:n,update:u})=>[i("button",{"py-4":"",border:"b base",flex:"~ col","p-3":"","w-full":"","text-primary":"","font-bold":"",onClick:()=>{u(),h(v)()}},b(a.$t("timeline.show_new_items",n,{named:{v:h(w)(n)}})),9,Dt)]),default:_(({item:n,active:u})=>[D?(o(),r(h(ot),{key:0,item:n,active:u,tag:"div"},{default:_(()=>[n.type==="grouped-follow"?(o(),r(l,{key:0,items:n,border:"b base"},null,8,["items"])):n.type==="grouped-reblogs-and-favourites"?(o(),r(f,{key:1,group:n,border:"b base"},null,8,["group"])):(o(),r(c,{key:2,notification:n,"hover:bg-active":"",border:"b base"},null,8,["notification"]))]),_:2},1032,["item","active"])):(o(),d(A,{key:1},[n.type==="grouped-follow"?(o(),r(l,{key:0,items:n,border:"b base"},null,8,["items"])):n.type==="grouped-reblogs-and-favourites"?(o(),r(f,{key:1,group:n,border:"b base"},null,8,["group"])):(o(),r(c,{key:2,notification:n,"hover:bg-active":"",border:"b base"},null,8,["notification"]))],64))]),_:1},8,["paginator","stream"])}}});export{Jt as _};
