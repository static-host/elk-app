import{d as g,b as y,e as b,m as w,w as f,I as x,o as i,j as n,t as c,h as m,c as u,L as _,M as T,f as $,l as h,k as I,cw as C,bp as E,_ as N}from"./entry.6470c283.js";import{n as B}from"./index.modern.9fe7b5ad.js";const S={p6:""},V={flex:"~ col gap2"},j=n("div",{my4:"",border:"t base"},null,-1),A=n("div",{"i-ri-download-2-line":""},null,-1),F=n("div",{"i-ri-upload-2-line":""},null,-1),P=g({__name:"index",setup(O){const{t:d}=y();b({title:()=>`${d("settings.users.label")} | ${d("nav.settings")}`});const s=C();async function v(){if(!confirm("Please aware that the tokens represent the **full access** to your accounts, and should be treated as sensitive information. Are you sure you want to export the tokens?"))return;const{saveAs:e}=await E(()=>import("./FileSaver.min.dea9a14f.js").then(a=>a.F),["./FileSaver.min.dea9a14f.js","./entry.6470c283.js","./entry.fd1aa0b4.css"],import.meta.url),o={"/":"Generated by Elk, you can import it to Elk to restore the tokens.","//":"This file represents the **full access** to your accounts, and should be treated as sensitive information.",version:1,origin:location.origin,users:s.value},r=new Blob([JSON.stringify(o,null,2)],{type:"application/json;charset=utf-8"});e(r,`elk-users-tokens-${new Date().toISOString().slice(0,10)}.json`)}async function k(){const e=await B({description:"Token File",mimeTypes:["application/json"]});try{const o=await e.text(),r=JSON.parse(o);if(r.version!==1)throw new Error("Invalid version");const a=r.users,t=[];for(const l of a)s.value.some(p=>p.server===l.server&&p.account.id===l.account.id)||t.push(l);if(t.length===0){alert("No new users found");return}if(!confirm(`Found ${t.length} new users, are you sure you want to import them?`))return;s.value=[...s.value,...t]}catch(o){console.error(o),alert("Invalid Elk tokens file")}}return(e,o)=>{const r=N,a=x;return i(),w(a,{"back-on-small-screen":""},{title:f(()=>[n("div",{"text-lg":"","font-bold":"",flex:"","items-center":"","gap-2":"",onClick:o[0]||(o[0]=(...t)=>e.$scrollToTop&&e.$scrollToTop(...t))},[n("span",null,c(e.$t("settings.users.label")),1)])]),default:f(()=>[n("div",S,[m(s).length?(i(),u(_,{key:0},[n("div",V,[(i(!0),u(_,null,T(m(s),t=>(i(),u("div",{key:t.account.id},[$(r,{account:t.account,"hover-card":!1},null,8,["account"])]))),128))]),j,n("button",{"btn-text":"",flex:"~ gap-2","items-center":"",onClick:v},[A,h(" "+c(e.$t("settings.users.export")),1)])],64)):I("",!0),n("button",{"btn-text":"",flex:"~ gap-2","items-center":"",onClick:k},[F,h(" "+c(e.$t("settings.users.import")),1)])])]),_:1})}}});export{P as default};
