import{d as U,az as Y,aA as Z,b as q,O as z,x as c,J as u,aC as F,c as m,j as e,h as t,m as $,w as r,k as B,a8 as H,a9 as I,ax as A,f as w,a3 as G,aG as D,L as K,a4 as J,p as O,o as n,l as P,t as b,a1 as ee,e as te,a as oe,I as se,aq as ne,aa as ie}from"./entry.6470c283.js";import{_ as Q}from"./CommonErrorMessage.vue.8ac3d45b.js";import{u as re}from"./index.b43e8091.js";import{c as ae}from"./CommonPaginator.vue.26cfe48c.js";const le=["aria-describedby"],de={key:0,"bg-base":"",border:"~ base",h10:"",m2:"","ps-1":"","pe-4":"","rounded-3":"","w-full":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":"","gap-3":""},ce=e("span",{block:"","text-current":"","i-ri:close-fill":""},null,-1),ue=[ce],pe={mr4:"",flex:"",gap2:""},fe=["disabled"],_e={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},me=e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1),be=[me],ve={key:1,block:"","text-current":"","i-ri:save-2-fill":"",class:"rtl-flip"},he=["onClick"],ye=e("span",{block:"","text-current":"","i-ri:edit-2-line":"",class:"rtl-flip"},null,-1),$e=[ye],ke=["disabled","onClick"],ge={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},xe=e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1),we=[xe],Ce={key:1,block:"","text-current":"","i-ri:delete-bin-2-line":"",class:"rtl-flip"},Ee=["id"],Ve={flex:"","items-center":"","gap-x-2":"","font-bold":""},Le=e("div",{"aria-hidden":"true","i-ri:error-warning-fill":""},null,-1),Me=["aria-label"],Re=e("span",{"aria-hidden":"true",w:"1.75em",h:"1.75em","i-ri:close-line":""},null,-1),Te=[Re],Be={"ps-2":"","sm:ps-1":""},De={flex:"~ col sm:row","gap-y-1":"","sm:gap-x-2":""},Ne={"sr-only":""},Se=U({__name:"ListEntry",props:{modelValue:{required:!0}},emits:Y(["listUpdated","listRemoved"],["update:modelValue"]),setup(j,{emit:L}){const a=Z(j,"modelValue"),{t:C}=q(),h=z(),{form:p,isDirty:f,submitter:y,reset:v}=re({form:()=>({...a.value})});let d=c(!1),_=c(!1),l=c(void 0);const k=c(),M=c(),o=c();async function g(){d.value=!0,l.value=void 0,await u(),k.value?.focus()}async function x(){d.value=!1,l.value=void 0,v(),await u(),M.value?.focus()}const{submit:R,submitting:T}=y(async()=>{try{a.value=await h.v1.lists.update(p.id,{title:p.title}),x()}catch(i){console.error(i),l.value=i.message,await u(),k.value?.focus()}});async function N(){if(_.value)return;const i=await ee({title:C("confirm.delete_list.title",[a.value.title]),confirm:C("confirm.delete_list.confirm"),cancel:C("confirm.delete_list.cancel")});if(_.value=!0,l.value=void 0,await u(),i==="confirm"){await u();try{await h.v1.lists.remove(a.value.id),L("listRemoved",a.value.id)}catch(s){console.error(s),l.value=s.message,await u(),o.value?.focus()}finally{_.value=!1}}else _.value=!1}async function S(){l.value=void 0,await u(),d.value?k.value?.focus():o.value?.focus()}return F(x),(i,s)=>{const E=J,W=O,X=Q;return n(),m(K,null,[e("form",{"hover:bg-active":"",flex:"","justify-between":"","items-center":"","gap-x-2":"","aria-describedby":t(l)?`action-list-error-${a.value.id}`:void 0,class:G(t(l)?"border border-base border-rounded rounded-be-is-0 rounded-be-ie-0 border-b-unset border-$c-danger-active":null),onSubmit:s[3]||(s[3]=D((...V)=>t(R)&&t(R)(...V),["prevent"]))},[t(d)?(n(),m("div",de,[t(d)?(n(),$(E,{key:0,content:i.$t("list.cancel_edit"),"no-auto-focus":""},{default:r(()=>[e("button",{type:"button","rounded-full":"","text-sm":"",p2:"","transition-colors":"","hover:text-primary":"",onClick:s[0]||(s[0]=V=>x())},ue)]),_:1},8,["content"])):B("",!0),H(e("input",{ref_key:"input",ref:k,"onUpdate:modelValue":s[1]||(s[1]=V=>t(p).title=V),"rounded-3":"","w-full":"","bg-transparent":"",outline:"focus:none","pe-4":"",pb:"1px","flex-1":"","placeholder-text-secondary":"",onKeydown:s[2]||(s[2]=A(V=>x(),["esc"]))},null,544),[[I,t(p).title]])])):(n(),$(W,{key:1,to:`list/${a.value.id}`,block:"",grow:"",p4:""},{default:r(()=>[P(b(t(p).title),1)]),_:1},8,["to"])),e("div",pe,[t(d)?(n(),$(E,{key:0,content:i.$t("list.save"),"no-auto-focus":""},{default:r(()=>[e("button",{type:"submit","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",disabled:t(_)||!t(f)||t(T)},[t(d)?(n(),m(K,{key:0},[t(T)?(n(),m("span",_e,be)):(n(),m("span",ve))],64)):B("",!0)],8,fe)]),_:1},8,["content"])):(n(),$(E,{key:1,content:i.$t("list.edit"),"no-auto-focus":""},{default:r(()=>[e("button",{ref_key:"editBtn",ref:M,type:"button","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",onClick:D(g,["prevent"])},$e,8,he)]),_:1},8,["content"])),w(E,{content:i.$t("list.delete"),"no-auto-focus":""},{default:r(()=>[e("button",{type:"button","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",disabled:t(d),onClick:D(N,["prevent"])},[t(_)?(n(),m("span",ge,we)):(n(),m("span",Ce))],8,ke)]),_:1},8,["content"])])],42,le),t(l)?(n(),$(X,{key:0,id:`action-list-error-${a.value.id}`,"described-by":`action-list-failed-${a.value.id}`,class:"rounded-bs-is-0 rounded-bs-ie-0 border-t-dashed m-b-2"},{default:r(()=>[e("header",{id:`action-list-failed-${a.value.id}`,flex:"","justify-between":""},[e("div",Ve,[Le,e("p",null,b(i.$t(`list.${t(d)?"edit_error":"delete_error"}`)),1)]),w(E,{placement:"bottom",content:i.$t("list.clear_error"),"no-auto-focus":""},{default:r(()=>[e("button",{flex:"","rounded-4":"",p1:"","hover:bg-active":"","cursor-pointer":"","transition-100":"","aria-label":i.$t("list.clear_error"),onClick:S},Te,8,Me)]),_:1},8,["content"])],8,Ee),e("ol",Be,[e("li",De,[e("strong",Ne,b(i.$t("list.error_prefix")),1),e("span",null,b(t(l)),1)])])]),_:1},8,["id","described-by"])):B("",!0)],64)}}}),je=e("div",{"i-ri:list-check":""},null,-1),Ke={"text-lg":"","font-bold":""},Ue=["aria-describedby","onSubmit"],qe={"bg-base":"",border:"~ base","flex-1":"",h10:"","ps-1":"","pe-4":"","rounded-2":"","w-full":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":"","gap-3":""},ze=["placeholder","onKeypress"],Fe={flex:"~ col","gap-y-4":"","gap-x-2":"",sm:"~ justify-between flex-row"},He=["disabled"],Ie={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},Ae=e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1),Ge=[Ae],Je={key:1,"aria-hidden":"true",block:"","i-material-symbols:playlist-add-rounded":"",class:"rtl-flip"},Oe={id:"create-list-failed",flex:"","justify-between":""},Pe={flex:"","items-center":"","gap-x-2":"","font-bold":""},Qe=e("div",{"aria-hidden":"true","i-ri:error-warning-fill":""},null,-1),We=["aria-label"],Xe=e("span",{"aria-hidden":"true",w:"1.75em",h:"1.75em","i-ri:close-line":""},null,-1),Ye=[Xe],Ze={"ps-2":"","sm:ps-1":""},et={flex:"~ col sm:row","gap-y-1":"","sm:gap-x-2":""},tt={"sr-only":""},rt=U({__name:"lists",setup(j){const{t:L}=q(),a=z(),C=a.v1.lists.list();te({title:()=>L("nav.lists")});const h=c(),p=c();let f=c(void 0),y=c(!1);const v=c(""),d=oe(()=>v.value.length>0);async function _(){if(!(y.value||!d.value)){y.value=!0,f.value=void 0,await u();try{const o=await a.v1.lists.create({title:v.value});h.value?.createEntry(o),v.value=""}catch(o){console.error(o),f.value=o.message,u(()=>{p.value?.focus()})}finally{y.value=!1}}}function l(o){f.value=void 0,o&&u(()=>{p.value?.focus()})}function k(o){h.value?.updateEntry(o)}function M(o){h.value?.removeEntry(o)}return F(()=>l(!1)),(o,g)=>{const x=O,R=Se,T=J,N=Q,S=ae,i=se;return n(),$(i,null,{title:r(()=>[w(x,{to:"/lists","timeline-title-style":"",flex:"","items-center":"","gap-2":"",onClick:o.$scrollToTop},{default:r(()=>[je,e("span",Ke,b(t(L)("nav.lists")),1)]),_:1},8,["onClick"])]),default:r(()=>[ne(o.$slots,"default",{},()=>[w(S,{ref_key:"paginatorRef",ref:h,paginator:t(C)},{default:r(({item:s})=>[w(R,{"model-value":s,"onUpdate:modelValue":k,onListRemoved:M},null,8,["model-value"])]),done:r(()=>[e("form",{border:"t base","p-4":"","w-full":"",flex:"~ wrap",relative:"","gap-3":"","aria-describedby":t(f)?"create-list-error":void 0,class:G(t(f)?"border border-base border-rounded rounded-be-is-0 rounded-be-ie-0 border-b-unset border-$c-danger-active":null),onSubmit:D(_,["prevent"])},[e("div",qe,[H(e("input",{ref_key:"inputRef",ref:p,"onUpdate:modelValue":g[0]||(g[0]=s=>ie(v)?v.value=s:null),"bg-transparent":"",outline:"focus:none","px-4":"",pb:"1px","flex-1":"","placeholder-text-secondary":"",placeholder:o.$t("list.list_title_placeholder"),onKeypress:A(_,["enter"])},null,40,ze),[[I,t(v)]])]),e("div",Fe,[e("button",{flex:"~ row","gap-x-2":"","items-center":"","btn-solid":"",disabled:!t(d)||t(y)},[t(y)?(n(),m("span",Ie,Ge)):(n(),m("span",Je)),P(" "+b(o.$t("list.create")),1)],8,He)])],42,Ue),t(f)?(n(),$(N,{key:0,id:"create-list-error","described-by":"create-list-failed",class:"rounded-bs-is-0 rounded-bs-ie-0 border-t-dashed m-b-2"},{default:r(()=>[e("header",Oe,[e("div",Pe,[Qe,e("p",null,b(o.$t("list.error")),1)]),w(T,{placement:"bottom",content:o.$t("list.clear_error"),"no-auto-focus":""},{default:r(()=>[e("button",{flex:"","rounded-4":"",p1:"","hover:bg-active":"","cursor-pointer":"","transition-100":"","aria-label":o.$t("list.clear_error"),onClick:g[1]||(g[1]=s=>l(!0))},Ye,8,We)]),_:1},8,["content"])]),e("ol",Ze,[e("li",et,[e("strong",tt,b(o.$t("list.error_prefix")),1),e("span",null,b(t(f)),1)])])]),_:1})):B("",!0)]),_:1},8,["paginator"])])]),_:3})}}});export{rt as default};
